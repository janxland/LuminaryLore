(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[669],{8812:function(t,e,s){"use strict";s.d(e,{Z:function(){return n}});var i=s(1750);let n=(0,i.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8178:function(t,e,s){"use strict";s.d(e,{Z:function(){return n}});var i=s(1750);let n=(0,i.Z)("X",[["line",{x1:"18",x2:"6",y1:"6",y2:"18",key:"15jfxm"}],["line",{x1:"6",x2:"18",y1:"6",y2:"18",key:"d1lma3"}]])},6414:function(t,e,s){Promise.resolve().then(s.bind(s,8594))},8594:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return I}});var i=s(9268),n=s(5032),a=s(3109),r=s(2092),l=s(5810),o=s(3894),c=s(9968),u=s(5470),d=s(5210),h=s(5629),m=s(551),x=s(7463),p=s(2874),v=s(8225),f=s(7646),b=s(5194),g=s(6006),y=s(7179),j=s(8993),k=s(4586),N=s(2772);class w extends N.l{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;let s=this.options;this.options=this.client.defaultMutationOptions(t),(0,y.VS)(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(e=this.currentMutation)||e.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var t;null==(t=this.currentMutation)||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();let e={listeners:!0};"success"===t.type?e.onSuccess=!0:"error"===t.type&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:void 0!==t?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){let t=this.currentMutation?this.currentMutation.state:(0,j.R)(),e={...t,isLoading:"loading"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){k.V.batch(()=>{if(this.mutateOptions&&this.hasListeners()){var e,s,i,n,a,r,l,o;t.onSuccess?(null==(e=(s=this.mutateOptions).onSuccess)||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(i=(n=this.mutateOptions).onSettled)||i.call(n,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)):t.onError&&(null==(a=(r=this.mutateOptions).onError)||a.call(r,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(l=(o=this.mutateOptions).onSettled)||l.call(o,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context))}t.listeners&&this.listeners.forEach(({listener:t})=>{t(this.currentResult)})})}}var C=s(9851),Z=s(7889);function S(){}var M=s(8812),R=s(1750);let E=(0,R.Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);function O(t){return(0,i.jsxs)("div",{className:"mb-3 flex justify-between rounded-xl border p-3 text-black transition-all dark:bg-zinc-800  dark:text-white",children:[(0,i.jsxs)("div",{className:"flex",children:[t.icon?(0,i.jsx)("img",{className:"mr-3 hidden h-16 w-24 object-contain md:block",src:t.icon,alt:t.name}):null,(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"mb-1 text-lg",children:[t.name,(0,i.jsx)("span",{className:"ml-1 rounded-full bg-black pl-2 pr-2 pt-1 pb-1 text-xs text-white dark:bg-neutral-600 dark:text-zinc-50",children:t.version})]}),(0,i.jsx)("p",{className:"text-sm",children:t.pkg})]})]}),(0,i.jsx)("div",{className:"flex items-end justify-end",children:t.children})]})}function T(){let{extensionStore:t}=(0,p.Yh)(),{t:e}=(0,o.$)("extensions"),[s,n]=(0,g.useState)(""),{data:a,error:r,isLoading:l}=(0,f.a)({queryKey:["getInstalledExtensions"],queryFn:()=>v.Qt.getAllExtensions()}),u=(0,b.NL)(),d=function(t,e,s){let i=(0,y.lV)(t,e,void 0),n=(0,b.NL)({context:i.context}),[a]=g.useState(()=>new w(n,i));g.useEffect(()=>{a.setOptions(i)},[a,i]);let r=(0,C.$)(g.useCallback(t=>a.subscribe(k.V.batchCalls(t)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),l=g.useCallback((t,e)=>{a.mutate(t,e).catch(S)},[a]);if(r.error&&(0,Z.L)(a.options.useErrorBoundary,[r.error]))throw r.error;return{...r,mutate:l,mutateAsync:r.mutate}}(v.Qt.deleteExtension,{onSuccess:()=>{u.invalidateQueries({queryKey:["getInstalledExtensions"]})}});if(r)return(0,i.jsx)(h.Z,{error:r});if(l)return(0,i.jsx)(m.Z,{});if(!a||0===a.length)return(0,i.jsxs)("div",{className:"mt-28 text-center",children:[(0,i.jsx)("p",{className:"text-2xl font-bold",children:e("no-installed-extension.title")}),(0,i.jsx)("p",{className:"text-sm",children:e("no-installed-extension.message")})]});let x=e=>{t.unloadExtension(e),d.mutate(e)},j=t=>{n(t)};return(0,i.jsxs)("div",{children:[a.map((t,s)=>(0,i.jsxs)(O,{name:t.name,pkg:t.package,version:t.version,icon:t.icon,children:[(0,i.jsxs)(c.Z,{onClick:()=>{j(t.package)},className:"ml-1 flex items-center",children:[(0,i.jsx)(M.Z,{size:18}),(0,i.jsx)("span",{className:"ml-1 hidden md:inline-block",children:e("settings")})]}),(0,i.jsxs)(c.Z,{onClick:()=>{x(t.package)},className:"ml-1 flex items-center",children:[(0,i.jsx)(E,{size:18}),(0,i.jsx)("span",{className:"ml-1 hidden md:inline-block",children:e("remove")})]})]},s)),(0,i.jsx)(P,{pkg:s,onClose:()=>n("")})]})}function P(t){let{pkg:e,onClose:s}=t,{extensionStore:n}=(0,p.Yh)(),a=n.getExtension(e),{t:r}=(0,o.$)("extensions"),l=()=>{let{error:t,isLoading:s,data:n,refetch:a}=(0,f.a)({queryKey:[e,"settings"],queryFn:()=>v.rK.getSettings(e)});if(t)return(0,i.jsx)(h.Z,{error:t});if(s)return(0,i.jsx)(m.Z,{});if(!n||!n.length)return null;let r=(t,s)=>{v.rK.setSetting(e,t,s),a()};return(0,i.jsxs)("div",{children:[(0,i.jsx)("hr",{className:"m-4"}),n.map((t,e)=>(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)(z,{settings:t,onChange:e=>{r(t.key,e)}}),(0,i.jsx)("p",{className:"text-sm text-black text-opacity-70",children:t.description})]},e))]})},c=[{name:r("ext-metadata.name"),value:null==a?void 0:a.name},{name:r("ext-metadata.package"),value:null==a?void 0:a.package},{name:r("ext-metadata.version"),value:null==a?void 0:a.version},{name:r("ext-metadata.language"),value:null==a?void 0:a.lang},{name:r("ext-metadata.ext-type"),value:null==a?void 0:a.type},{name:r("ext-metadata.original-site"),value:null==a?void 0:a.webSite},{name:r("ext-metadata.author"),value:null==a?void 0:a.author},{name:r("ext-metadata.license"),value:null==a?void 0:a.license},{name:r("ext-metadata.description"),value:null==a?void 0:a.description}];return(0,i.jsxs)(x.Z,{show:!!e,onClose:s,title:r("ext-metadata.title",{extName:null==a?void 0:a.name}),children:[(0,i.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:c.map((t,e)=>t.value&&(0,i.jsxs)("p",{children:[(0,i.jsxs)("span",{className:"font-bold",children:[t.name,": "]}),t.value]},e))}),(0,i.jsx)(l,{})]})}function z(t){var e;let{settings:s,onChange:n}=t,[a,r]=(0,g.useState)(null!==(e=s.value)&&void 0!==e?e:s.defaultValue),l=t=>{r(t.target.value),n(t.target.value)};return"input"===s.type?(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"mb-3 font-bold",children:s.title}),(0,i.jsx)(u.Z,{className:"mb-3 w-full",value:String(a),onChange:l})]}):"select"===s.type?s.options?(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"mb-2 font-bold",children:s.title}),(0,i.jsx)(d.Z,{className:"!w-full",options:s.options,selected:String(a),onChange:l})]}):null:"checkbox"===s.type?(0,i.jsx)("div",{children:(0,i.jsxs)("label",{htmlFor:s.key,children:[(0,i.jsx)("input",{className:"mr-1 inline-block",type:"checkbox",id:s.key,checked:!!a,onChange:t=>{n(!!t.target.checked),r(!!t.target.checked)}}),s.title]})}):null}var F=s(3697);let V=(0,R.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),q=(0,R.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var G=s(9308),_=s(8119),K=s(2458);let $=(0,G.Pi)(()=>{let{settingsStore:t,extensionStore:e}=(0,p.Yh)(),[s,n]=(0,g.useState)(new Map),{enqueueSnackbar:a}=(0,_.Ds)(),{t:r}=(0,o.$)("extensions");(0,g.useEffect)(()=>{v.Qt.getAllExtensions().then(t=>{let e=new Map;t.forEach(t=>{e.set(t.package,!0)}),n(e)})},[]);let l=(t,e)=>{n(s=>{let i=new Map(s);return i.set(t,e),i})},{data:u,error:d,isLoading:x,refetch:b}=(0,f.a)({queryKey:["getRepoExtensions"],queryFn:async()=>{let e=await K.ZP.get(t.getSetting("miruRepo")+"/index.json");return e.filter(e=>e.type===(0,F.P)(t.getSetting("model")))}});if((0,g.useEffect)(()=>{b()},[t.getSetting("model")]),d)return(0,i.jsx)(h.Z,{error:d});if(x)return(0,i.jsx)("div",{className:"m-14",children:(0,i.jsx)(m.Z,{})});if(!u||0===u.length)return(0,i.jsxs)("div",{className:"mt-28 text-center",children:[(0,i.jsx)("p",{className:"text-2xl font-bold",children:r("not-find-extension.title")}),(0,i.jsx)("p",{className:"text-sm",children:r("not-find-extension.message")})]});let y=async s=>{let i=await K.ZP.get("".concat(t.getSetting("miruRepo"),"/repo/").concat(s.trim(),".js"));i||a(r("download-error"),{variant:"error"}),e.installExtension(i).then(()=>{l(s,!0)}).catch(t=>{a(t,{variant:"error"})})},j=async t=>{e.unloadExtension(t),l(t,!1)},k=async t=>{await j(t),await y(t)};return(0,i.jsx)("div",{children:u.map((t,n)=>{var a;return(0,i.jsxs)(O,{name:t.name,pkg:t.package,version:t.version,icon:t.icon,children:[s.get(t.package)&&t.version!==(null===(a=e.getExtension(t.package))||void 0===a?void 0:a.version)&&(0,i.jsxs)(c.Z,{onClick:()=>{k(t.package)},className:"ml-1 flex items-center",children:[(0,i.jsx)(V,{size:18}),(0,i.jsx)("span",{className:"ml-1 hidden md:inline-block",children:r("update")})]}),s.get(t.package)?(0,i.jsxs)(c.Z,{onClick:()=>{j(t.package)},className:"ml-1 flex items-center",children:[(0,i.jsx)(E,{size:18}),(0,i.jsx)("span",{className:"ml-1 hidden md:inline-block",children:r("remove")})]}):(0,i.jsxs)(c.Z,{onClick:()=>{y(t.package)},className:"ml-1 flex items-center",children:[(0,i.jsx)(q,{size:18}),(0,i.jsx)("span",{className:"ml-1 hidden md:inline-block",children:r("install")})]})]},n)})})});var L=s(7356);function I(){let{t}=(0,o.$)("extensions");return(0,g.useEffect)(()=>{(0,L.Z)(t("title"))},[]),(0,i.jsx)(a.default,{children:(0,i.jsxs)(n.Z,{children:[(0,i.jsx)(r.Z,{title:t("title")}),(0,i.jsx)(l.Z,{tabs:[{title:t("installed"),content:(0,i.jsx)(T,{})},{title:t("repository"),content:(0,i.jsx)($,{})}]})]})})}},5032:function(t,e,s){"use strict";s.d(e,{Z:function(){return a}});var i=s(9268),n=s(9791);function a(t){return(0,i.jsx)("div",{...t,className:(0,n.Z)("pl-5 pt-5 pr-5 md:pl-10 md:pr-10 md:pt-10",t.className),children:t.children})}},5629:function(t,e,s){"use strict";s.d(e,{Z:function(){return r}});var i=s(9268),n=s(3894),a=s(6006);function r(t){let{error:e}=t,[s,r]=(0,a.useState)(""),{t:l}=(0,n.$)();return((0,a.useEffect)(()=>{if(e){if("object"==typeof e)return r(e.toString());r(e)}},[e]),s)?(0,i.jsxs)("div",{className:"my-28 text-center",children:[(0,i.jsx)("p",{className:"text-2xl font-bold",children:l("an-error-has-occurred")}),(0,i.jsx)("p",{className:"text-sm",children:s})]}):null}},3109:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return a}});var i=s(9268),n=s(3039);function a(t){return(0,i.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:0},children:t.children})}},7463:function(t,e,s){"use strict";s.d(e,{Z:function(){return a}});var i=s(9268),n=s(8178);function a(t){return t.show?(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"fixed left-0 right-0 top-0 bottom-0 z-50 bg-black opacity-75",onClick:t.onClose}),(0,i.jsxs)("div",{className:"fixed top-1/2 left-0 right-0 z-50 max-h-screen -translate-y-1/2 transform overflow-auto md:left-1/2 md:-translate-x-1/2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between rounded-t-lg border-b bg-white p-4 dark:border-white dark:bg-zinc-700",children:[(0,i.jsx)("div",{className:"text-lg font-bold",children:t.title}),(0,i.jsx)("div",{className:"cursor-pointer text-gray-400 hover:text-gray-500",onClick:t.onClose,children:(0,i.jsx)(n.Z,{})})]}),(0,i.jsx)("div",{className:"rounded-b-lg bg-white p-4 dark:bg-zinc-800",children:t.children})]})]}):null}},2092:function(t,e,s){"use strict";var i=s(9268),n=s(3894),a=s(2874),r=s(9308),l=s(5810);let o=(0,r.Pi)(t=>{let{settingsStore:e}=(0,a.Yh)(),{t:s}=(0,n.$)(),r=[{title:s("bangumi")},{title:s("manga")},{title:s("fikushon")}],o=s=>{var i;e.setSetting("model",s),null===(i=t.handleTabChange)||void 0===i||i.call(t,s)};return(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("h1",{className:"mb-5 text-3xl font-bold",children:t.title}),(0,i.jsx)(l.Z,{tabs:r,onChange:o,index:e.getSetting("model")})]})});e.Z=o},5810:function(t,e,s){"use strict";s.d(e,{Z:function(){return r}});var i=s(9268),n=s(9791),a=s(6006);function r(t){var e;let[s,r]=(0,a.useState)(0),l=e=>{var s;r(e),null===(s=t.onChange)||void 0===s||s.call(t,e)};(0,a.useEffect)(()=>{void 0!==t.index&&r(Number(t.index))},[t.index,t.tabs]);let o=t.tabs.map((t,e)=>(0,i.jsx)("button",{onClick:()=>l(e),className:(0,n.Z)("mr-2 break-keep rounded-full border pl-3 pr-3 pt-2 pb-2 text-sm ","".concat(s===e?"bg-black text-white dark:bg-black ":"bg-white dark:bg-zinc-700")),children:t.title},e));return(0,i.jsx)("div",{className:(0,n.Z)("overflow-x-scroll scrollbar-none"),children:t.tabs.length>0&&(0,i.jsxs)(i.Fragment,{children:[t.tabs.length>1&&(0,i.jsx)("div",{className:(0,n.Z)("flex overflow-auto scrollbar-none mb-3",t.className),children:o}),(0,i.jsx)("div",{children:null===(e=t.tabs[s])||void 0===e?void 0:e.content})]})})}},9968:function(t,e,s){"use strict";s.d(e,{Z:function(){return r}});var i=s(9268),n=s(9791),a=s(1816);function r(t){return(0,i.jsx)("button",{...t,className:(0,n.W)("rounded-3xl border bg-black pl-4 pr-4 pt-2 pb-2 text-sm text-white focus:ring-2 focus:ring-gray-500",t.className),children:t.loading&&(0,i.jsx)(a.Z,{className:"animate-spin"})||t.children})}},5470:function(t,e,s){"use strict";s.d(e,{Z:function(){return a}});var i=s(9268),n=s(9791);function a(t){return(0,i.jsx)("input",{...t,className:(0,n.Z)("rounded-3xl border pl-4 pr-4 pt-2 pb-2 text-sm dark:bg-black dark:text-white",t.className)})}},5210:function(t,e,s){"use strict";s.d(e,{Z:function(){return a}});var i=s(9268),n=s(9791);function a(t){let{options:e,selected:s,onChange:a,className:r}=t;return(0,i.jsx)("select",{onChange:a,defaultValue:s,className:(0,n.Z)("mr-3 mb-3 w-full rounded-3xl border pl-3 pt-2 pb-2  pr-3 text-sm dark:bg-black md:w-96",r),children:e.map((t,e)=>(0,i.jsx)("option",{value:t.value,children:t.label},e))})}},3697:function(t,e,s){"use strict";function i(t){switch(Number(t)){case 0:default:return"bangumi";case 1:return"manga";case 2:return"fikushon"}}s.d(e,{P:function(){return i}})},7356:function(t,e,s){"use strict";function i(t){document.title="".concat(t," | Miru")}s.d(e,{Z:function(){return i}})},1728:function(t,e,s){"use strict";s.d(e,{_:function(){return i}});let i=console},8993:function(t,e,s){"use strict";s.d(e,{R:function(){return o},m:function(){return l}});var i=s(1728),n=s(4586),a=s(8511),r=s(760);class l extends a.F{constructor(t){super(),this.defaultOptions=t.defaultOptions,this.mutationId=t.mutationId,this.mutationCache=t.mutationCache,this.logger=t.logger||i._,this.observers=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options={...this.defaultOptions,...t},this.updateCacheTime(this.options.cacheTime)}get meta(){return this.options.meta}setState(t){this.dispatch({type:"setState",state:t})}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.mutationCache.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.observers=this.observers.filter(e=>e!==t),this.scheduleGc(),this.mutationCache.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.observers.length||("loading"===this.state.status?this.scheduleGc():this.mutationCache.remove(this))}continue(){var t,e;return null!=(t=null==(e=this.retryer)?void 0:e.continue())?t:this.execute()}async execute(){var t,e,s,i,n,a,l,o,c,u,d,h,m,x,p,v,f,b,g,y;let j="loading"===this.state.status;try{if(!j){this.dispatch({type:"loading",variables:this.options.variables}),await (null==(c=(u=this.mutationCache.config).onMutate)?void 0:c.call(u,this.state.variables,this));let t=await (null==(d=(h=this.options).onMutate)?void 0:d.call(h,this.state.variables));t!==this.state.context&&this.dispatch({type:"loading",context:t,variables:this.state.variables})}let m=await (()=>{var t;return this.retryer=(0,r.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(this.state.variables):Promise.reject("No mutationFn found"),onFail:(t,e)=>{this.dispatch({type:"failed",failureCount:t,error:e})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:null!=(t=this.options.retry)?t:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode}),this.retryer.promise})();return await (null==(t=(e=this.mutationCache.config).onSuccess)?void 0:t.call(e,m,this.state.variables,this.state.context,this)),await (null==(s=(i=this.options).onSuccess)?void 0:s.call(i,m,this.state.variables,this.state.context)),await (null==(n=(a=this.mutationCache.config).onSettled)?void 0:n.call(a,m,null,this.state.variables,this.state.context,this)),await (null==(l=(o=this.options).onSettled)?void 0:l.call(o,m,null,this.state.variables,this.state.context)),this.dispatch({type:"success",data:m}),m}catch(t){try{throw await (null==(m=(x=this.mutationCache.config).onError)?void 0:m.call(x,t,this.state.variables,this.state.context,this)),await (null==(p=(v=this.options).onError)?void 0:p.call(v,t,this.state.variables,this.state.context)),await (null==(f=(b=this.mutationCache.config).onSettled)?void 0:f.call(b,void 0,t,this.state.variables,this.state.context,this)),await (null==(g=(y=this.options).onSettled)?void 0:g.call(y,void 0,t,this.state.variables,this.state.context)),t}finally{this.dispatch({type:"error",error:t})}}}dispatch(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"loading":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!(0,r.Kw)(this.options.networkMode),status:"loading",variables:t.variables};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"};case"setState":return{...e,...t.state}}})(this.state),n.V.batch(()=>{this.observers.forEach(e=>{e.onMutationUpdate(t)}),this.mutationCache.notify({mutation:this,type:"updated",action:t})})}}function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0}}},8511:function(t,e,s){"use strict";s.d(e,{F:function(){return n}});var i=s(7179);class n{destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),(0,i.PN)(this.cacheTime)&&(this.gcTimeout=setTimeout(()=>{this.optionalRemove()},this.cacheTime))}updateCacheTime(t){this.cacheTime=Math.max(this.cacheTime||0,null!=t?t:i.sk?1/0:3e5)}clearGcTimeout(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)}}}},function(t){t.O(0,[147,684,947,646,371,667,139,744],function(){return t(t.s=6414)}),_N_E=t.O()}]);